<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <title>Cashback Requests - GoMint</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <style>
    :root {
      --primary-color: #667eea;
      --secondary-color: #764ba2;
      --accent-color: #ff6b35;
      --success-color: #10b981;
      --warning-color: #f59e0b;
      --error-color: #ef4444;
      --background-color: #f8fafc;
      --card-background: rgba(255, 255, 255, 0.95);
      --text-primary: #1e293b;
      --text-secondary: #64748b;
      --border-color: #e2e8f0;
      --border-radius: 1rem;
      --shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
      --transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Inter', sans-serif;
      background: linear-gradient(135deg, var(--primary-color) 0%, var(--secondary-color) 100%);
      min-height: 100vh;
      color: var(--text-primary);
      line-height: 1.6;
    }

    /* Header Styles */
    header {
      background: rgba(255, 255, 255, 0.95);
      backdrop-filter: blur(10px);
      border-bottom: 1px solid var(--border-color);
      padding: 1rem 2rem;
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      z-index: 1000;
      display: flex;
      justify-content: space-between;
      align-items: center;
      box-shadow: var(--shadow);
    }

    .logo {
      font-size: 1.5rem;
      font-weight: 700;
      background: linear-gradient(135deg, var(--primary-color) 0%, var(--secondary-color) 100%);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }

    nav {
      display: flex;
      gap: 2rem;
    }

    nav a {
      color: var(--text-secondary);
      text-decoration: none;
      font-weight: 500;
      transition: var(--transition);
      padding: 0.5rem 1rem;
      border-radius: 0.5rem;
    }

    nav a:hover {
      color: var(--primary-color);
      background: rgba(102, 126, 234, 0.1);
    }

    /* Main Container */
    .container {
      max-width: 600px;
      margin: 8rem auto 2rem;
      padding: 2.5rem;
      background: var(--card-background);
      backdrop-filter: blur(10px);
      border-radius: var(--border-radius);
      box-shadow: var(--shadow);
      border: 1px solid rgba(255, 255, 255, 0.2);
      animation: fadeInUp 0.6s ease-out;
    }

    @keyframes fadeInUp {
      from {
        opacity: 0;
        transform: translateY(30px);
      }

      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    h1 {
      font-size: 2rem;
      font-weight: 700;
      text-align: center;
      margin-bottom: 0.5rem;
      background: linear-gradient(135deg, var(--primary-color) 0%, var(--secondary-color) 100%);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }

    .subheading {
      text-align: center;
      color: var(--text-secondary);
      margin-bottom: 2rem;
      font-size: 1rem;

      color: #334155;
      font-weight: 600;
    }





    /* Filter Box */
    .filter-box {
      display: flex;
      justify-content: center;
      align-items: center;
      gap: 1rem;
      margin-bottom: 2rem;
      padding: 1.5rem;
      background: rgba(255, 255, 255, 0.8);
      border-radius: var(--border-radius);
      box-shadow: 0 4px 15px rgba(0, 0, 0, 0.05);
    }

    .filter-box label {
      font-weight: 600;
      color: var(--text-primary);
      font-size: 1rem;
    }

    select {
      padding: 0.75rem 1rem;
      border: 2px solid var(--border-color);
      border-radius: 0.75rem;
      font-size: 1rem;
      background: white;
      color: var(--text-primary);
      cursor: pointer;
      transition: var(--transition);
      min-width: 150px;
    }

    select:focus {
      outline: none;
      border-color: var(--primary-color);
      box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
    }

    .section-title {
      font-size: 1.25rem;
      font-weight: 600;
      color: var(--text-primary);
      margin: 2rem 0 1rem;
      padding-bottom: 0.5rem;
      border-bottom: 2px solid var(--primary-color);
    }

    .form-group {
      margin-bottom: 1.5rem;
      position: relative;
    }

    .form-group:hover label {
      color: var(--primary-color);
    }

    .form-group label {
      display: block;
      font-weight: 600;
      color: var(--text-primary);
      margin-bottom: 0.5rem;
      font-size: 0.95rem;
      transition: var(--transition);
    }

    input[type="text"],
    input[type="number"],
    input[type="tel"],
    select {
      width: 100%;
      padding: 1rem;
      border: 2px solid var(--border-color);
      border-radius: 0.75rem;
      font-size: 1rem;
      background: white;
      color: var(--text-primary);
      transition: var(--transition);
      outline: none;
      font-family: 'Inter', sans-serif;
    }

    input:focus,
    select:focus {
      border-color: var(--primary-color);
      box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
      transform: translateY(-1px);
    }

    input[readonly] {
      background: rgba(255, 255, 255, 0.8);
      cursor: not-allowed;
    }

    .flag-selector {
      display: flex;
      align-items: center;
      border: 2px solid var(--border-color);
      border-radius: 0.75rem;
      background: white;
      transition: var(--transition);
      overflow: hidden;
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
    }

    .flag-selector:focus-within {
      border-color: var(--primary-color);
      box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
    }

    .country-select {
      border: none;
      background: transparent;
      font-size: 0.95rem;
      padding: 1rem 0.5rem;
      cursor: pointer;
      outline: none;
      color: var(--text-primary);
      border-right: 1px solid var(--border-color);
      min-width: 80px;
      max-width: 100px;
      font-weight: 500;
    }

    .country-select:focus {
      background: rgba(102, 126, 234, 0.05);
    }

    .flag-selector input {
      border: none;
      outline: none;
      font-size: 1rem;
      padding: 1rem;
      background: transparent;
      flex: 1;
      color: var(--text-primary);
      font-family: inherit;
    }

    .flag-selector input::placeholder {
      color: var(--text-secondary);
      opacity: 0.7;
    }

    /* Table Styles */
    .table-container {
      overflow-x: auto;
      border-radius: var(--border-radius);
      box-shadow: var(--shadow);
    }

    table {
      width: 100%;
      border-collapse: collapse;
      background: white;
      border-radius: var(--border-radius);
      overflow: hidden;
    }

    th {
      background: linear-gradient(135deg, var(--primary-color) 0%, var(--secondary-color) 100%);
      color: white;
      padding: 1rem;
      text-align: left;
      font-weight: 600;
      font-size: 0.9rem;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }

    td {
      padding: 1rem;
      border-bottom: 1px solid var(--border-color);
      color: var(--text-primary);
    }

    tbody tr {
      transition: var(--transition);
    }

    tbody tr:hover {
      background: rgba(102, 126, 234, 0.05);
    }

    /* Status Styles */
    .status-pending {
      color: var(--warning-color);
      font-weight: 600;
      padding: 0.25rem 0.75rem;
      border-radius: 9999px;
      background: rgba(245, 158, 11, 0.1);
      display: inline-block;
    }

    .status-approved {
      color: var(--success-color);
      font-weight: 600;
      padding: 0.25rem 0.75rem;
      border-radius: 9999px;
      background: rgba(16, 185, 129, 0.1);
      display: inline-block;
    }

    .status-rejected {
      color: var(--error-color);
      font-weight: 600;
      padding: 0.25rem 0.75rem;
      border-radius: 9999px;
      background: rgba(239, 68, 68, 0.1);
      display: inline-block;
    }

    /* Button Styles */
    .btn-details {
      padding: 0.5rem 1rem;
      background: linear-gradient(135deg, var(--accent-color) 0%, #f7931e 100%);
      color: white;
      border: none;
      border-radius: 0.5rem;
      font-size: 0.9rem;
      font-weight: 500;
      cursor: pointer;
      transition: var(--transition);
      box-shadow: 0 2px 10px rgba(255, 107, 53, 0.3);
    }

    .btn-details:hover {
      transform: translateY(-1px);
      box-shadow: 0 4px 15px rgba(255, 107, 53, 0.4);
    }

    /* Modal Styles */
    .modal {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.6);
      backdrop-filter: blur(5px);
      justify-content: center;
      align-items: center;
      z-index: 1000;
      animation: fadeIn 0.3s ease-out;
    }

    @keyframes fadeIn {
      from {
        opacity: 0;
      }

      to {
        opacity: 1;
      }
    }

    .modal-content {
      background: var(--card-background);
      backdrop-filter: blur(10px);
      padding: 2rem;
      border-radius: var(--border-radius);
      width: 90%;
      max-width: 500px;
      box-shadow: 0 20px 40px rgba(0, 0, 0, 0.2);
      position: relative;
      animation: slideIn 0.3s ease-out;
    }

    @keyframes slideIn {
      from {
        opacity: 0;
        transform: translateY(-20px) scale(0.95);
      }

      to {
        opacity: 1;
        transform: translateY(0) scale(1);
      }
    }

    .modal-content h2 {
      margin-top: 0;
      font-size: 1.5rem;
      font-weight: 600;
      margin-bottom: 1.5rem;
      color: var(--text-primary);
      text-align: center;
    }

    .modal-content p {
      margin: 0.75rem 0;
      font-size: 1rem;
      color: var(--text-secondary);
    }

    .modal-content p strong {
      color: var(--text-primary);
      font-weight: 600;
    }

    .close-btn {
      position: absolute;
      top: 1rem;
      right: 1.5rem;
      font-size: 1.5rem;
      cursor: pointer;
      color: var(--text-secondary);
      transition: var(--transition);
      width: 2rem;
      height: 2rem;
      display: flex;
      align-items: center;
      justify-content: center;
      border-radius: 50%;
    }

    .close-btn:hover {
      color: var(--text-primary);
      background: rgba(0, 0, 0, 0.1);
    }

    /* Footer Link */
    .footer-link {
      text-align: center;
      margin-top: 2rem;
      padding: 1.5rem;
    }

    .footer-link a {
      color: var(--primary-color);
      font-weight: 600;
      text-decoration: none;
      font-size: 1rem;
      transition: var(--transition);
      padding: 0.75rem 1.5rem;
      border-radius: 0.75rem;
      background: rgba(102, 126, 234, 0.1);
    }

    .footer-link a:hover {
      background: rgba(102, 126, 234, 0.2);
      transform: translateY(-1px);
    }

    .button-row {
      display: flex;
      gap: 1rem;
      justify-content: center;
      margin-top: 2rem;
      flex-wrap: wrap;
    }

    .submit-btn {
      background: linear-gradient(135deg, var(--accent-color) 0%, #f7931e 100%);
      color: white;
      border: none;
      padding: 1.2rem 3rem;
      border-radius: 0.75rem;
      font-size: 1.1rem;
      font-weight: 600;
      cursor: pointer;
      transition: var(--transition);
      box-shadow: 0 4px 15px rgba(255, 107, 53, 0.3);
      position: relative;
      overflow: hidden;
    }

    .submit-btn::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
      transition: left 0.5s;
    }

    .submit-btn:hover::before {
      left: 100%;
    }

    .submit-btn:hover {
      transform: translateY(-3px);
      box-shadow: 0 8px 25px rgba(255, 107, 53, 0.5);
      background: linear-gradient(135deg, #f7931e 0%, var(--accent-color) 100%);
    }

    .submit-btn:active {
      transform: translateY(-1px);
      box-shadow: 0 4px 15px rgba(255, 107, 53, 0.4);
    }

    .cancel-btn {
      background: var(--border-color);
      color: var(--text-secondary);
      border: none;
      padding: 1.2rem 3rem;
      border-radius: 0.75rem;
      font-size: 1.1rem;
      font-weight: 600;
      cursor: pointer;
      transition: var(--transition);
      margin-right: 1rem;
    }

    .cancel-btn:hover {
      background: #cbd5e1;
      color: var(--text-primary);
      transform: translateY(-2px);
    }

    /* Responsive Design */
    @media (max-width: 768px) {
      header {
        padding: 1rem;
        flex-direction: column;
        gap: 1rem;
      }

      nav {
        gap: 1rem;
      }

      .container {
        margin: 6rem auto 2rem;
        padding: 1.5rem;
      }

      h1 {
        font-size: 2rem;
      }

      .filter-box {
        flex-direction: column;
        gap: 0.5rem;
        text-align: center;
      }

      .modal-content {
        width: 95%;
        padding: 1.5rem;
      }

      th,
      td {
        padding: 0.75rem 0.5rem;
        font-size: 0.9rem;
      }

      .btn-details {
        padding: 0.5rem 0.75rem;
        font-size: 0.8rem;
      }

      .button-row {
        flex-direction: column;
        align-items: stretch;
      }

      .submit-btn {
        width: 100%;
      }

      .flag-selector {
        flex-direction: column;
        align-items: stretch;
      }

      .country-select {
        border-right: none;
        border-bottom: 1px solid var(--border-color);
        border-radius: 0;
        padding: 0.75rem 0.5rem;
        min-width: 70px;
        max-width: 80px;
      }

      .flag-selector input {
        padding: 0.75rem 1rem;
      }
    }
  </style>
</head>

<body>
  <header>
    <div class="logo">GoMint</div>
    <nav>
      <a href="customerCashBackReward.html">My Rewards</a>
      <a href="customerProfile.html">My Profile</a>
      <a href="index.html">Logout</a>
    </nav>
  </header>

  <div class="container">

    <p class="subheading">Submit a new cashback request</p>

    <form id="cashbackForm">

      <div class="section-title">Business Information</div>

      <div class="form-group">
        <label>Select Business</label>
        <select id="businessName" required>
          <option value="">Select Business</option>
          <option>Demo Business</option>
          <option>Business A</option>
          <option>Business B</option>
        </select>
      </div>

      <div class="form-group">
        <label>Select Business Location</label>
        <select id="businessLocation" required>
          <option value="">Select Location</option>
          <option>Demo Business location</option>
          <option>Location A</option>
          <option>Location B</option>
        </select>
      </div>

      <div class="form-group">
        <label>Officer Information</label>
        <input type="text" id="officerInfo" placeholder="Enter officer information" required>
      </div>

      <div class="form-group">
        <label>Search Customer</label>
        <div class="flag-selector">
          <select class="country-select">
            <option value="+1">ðŸ‡ºðŸ‡¸ +1</option>
            <option value="+91" selected>ðŸ‡®ðŸ‡³ +91</option>
            <option value="+44">ðŸ‡¬ðŸ‡§ +44</option>
          </select>
          <input type="tel" id="phoneNumber" placeholder="(234) 564-321" required>
        </div>
      </div>

      <div class="form-group">
        <label>Cashback Amount ($)</label>
        <input type="text" id="cashbackAmount" placeholder="Enter amount" required>
      </div>

      <div class="button-row">
        <button type="button" class="submit-btn" onclick="validateAndSubmit()">Submit Request</button>
        <button type="button" class="cancel-btn"
          onclick="window.location.href='customercashBackReward.html'">Cancel</button>
      </div>

    </form>
  </div>



  <script>
    // Extract customer ID from token
    function getCustomerId() {
      const token = localStorage.getItem('token');
      if (!token) {
        window.location.href = 'customerLogin.html';
        return null;
      }
      try {
        // Token is stored as btoa(JSON) from login
        const decoded = JSON.parse(atob(token));
        return decoded.sub; // sub contains the customer ID
      } catch (err) {
        console.error('Failed to decode token:', err);
        localStorage.removeItem('token');
        window.location.href = 'customerLogin.html';
        return null;
      }
    }

    // Load customer profile on page load
    window.onload = function () {
      const customerId = getCustomerId();
      if (!customerId) return;

      const token = localStorage.getItem('token');
      fetch(`http://localhost:3001/api/customers/${customerId}`, {
        method: 'GET',
        headers: {
          'Authorization': `Bearer ${token}`
        }
      })
        .then(response => {
          if (!response.ok) throw new Error('Failed to fetch profile');
          return response.json();
        })
        .then(profileData => {
          // Auto-populate mobile number
          if (profileData.mobile) {
            document.getElementById('phoneNumber').value = profileData.mobile;
          }
        })
        .catch(err => {
          console.error('Error loading profile:', err);
        });
    }

    function validateAndSubmit() {
      const businessName = document.getElementById("businessName").value;
      const businessLocation = document.getElementById("businessLocation").value;
      const officerInfo = document.getElementById("officerInfo").value.trim();
      const phoneNumber = document.getElementById("phoneNumber").value.trim();
      const cashbackAmount = document.getElementById("cashbackAmount").value.trim();

      if (!businessName || !businessLocation || !officerInfo || !phoneNumber || !cashbackAmount) {
        alert("Please fill in all required fields.");
        return;
      }

      if (isNaN(cashbackAmount) || parseFloat(cashbackAmount) <= 0) {
        alert("Please enter a valid cashback amount.");
        return;
      }

      // Create request object
      const requestData = {
        id: Date.now(), // Unique ID based on timestamp
        number: 'REQ-' + Date.now().toString().slice(-6),
        amount: '$' + parseFloat(cashbackAmount).toFixed(2),
        status: 'pending',
        date: new Date().toISOString().split('T')[0], // YYYY-MM-DD format
        details: {
          requestDate: new Date().toLocaleDateString(),
          type: 'Cashback',
          status: 'Pending',
          notes: 'Cashback request submitted',
          business: businessName,
          location: businessLocation,
          officer: officerInfo,
          phone: phoneNumber,
          invoice: 'N/A'
        }
      };

      // Save to localStorage
      const existingRequests = JSON.parse(localStorage.getItem('cashbackRequests') || '[]');
      existingRequests.push(requestData);
      localStorage.setItem('cashbackRequests', JSON.stringify(existingRequests));

      alert("Cashback request submitted successfully.");
      window.location.href = "customerCashbackRequestList.html";
    }
  </script>

</body>

</html>